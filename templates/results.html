<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoFlood</title>
    <link href="{{url_for('static',filename='css/output.css')}}" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400..900&display=swap" rel="stylesheet">

    <style>
        /* Ensure the body takes full height and uses flexbox */
        html,
        body {
            font-family: "Playfair Display", serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Footer styling */
        footer {
            background-color: transparent;
            text-align: center;
            padding: 10px 0;
            width: 100%;
            position: static;
            bottom: 0;
        }

        /* Always underline the Carpal Tunnel Team link */
        footer a {
            color: #007bff;
            text-decoration: underline;
        }

        footer a:hover {
            text-decoration: underline;
            /* Ensure underline persists on hover */
        }
    </style>
</head>

<body>
    <!-- The Logo -->
    <a href="{{ url_for('home') }}">
        <img src="{{ url_for('static', filename='images/sofloodlogo.png') }}" alt="SoFlood Logo" class="w-50 h-20 mb-4"
            style="float: left; margin-top: 20px; margin-bottom: 20px; margin-left: 20px; margin-right: 20px;">
    </a>


    <div id="loader" class="flex h-full justify-center scale-[2]">
        <span class="loading loading-spinner loading-lg"></span>
    </div>

    <!-- Main Content Section -->
    <main id="main-content" class="mx-[3rem] hidden">
        <div class="flex justify-center gap-[2rem] mt-[2rem]">
            <div class="stats shadow w-[25%]">
                <div class="stat">
                    <div class="stat-figure text-secondary">
                        <!--<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"-->
                        <!--    class="inline-block h-8 w-8 stroke-current">-->
                        <!--    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"-->
                        <!--        d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>-->
                        <!--</svg>-->
                    </div>
                    <div class="stat-title">FEMA Score</div>
                    <div id="fema-prediction-value" class="stat-value text-center"></div>
                </div>
            </div>
            <div class="stats shadow w-[25%]">
                <div class="stat">
                    <div class="stat-figure text-secondary">
                        <!--<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"-->
                        <!--    class="inline-block h-8 w-8 stroke-current">-->
                        <!--    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"-->
                        <!--        d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>-->
                        <!--</svg>-->
                    </div>
                    <div class="stat-title">Carpal Tunnel Score</div>
                    <div id="carpal-tunnel-prediction-value" class="stat-value text-center"></div>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-[1rem] flex-col">
            <div class="collapse collapse-arrow bg-base-200 mt-[3rem] w-[50%]">
                <input type="radio" name="my-accordion-2" />
                <div class="collapse-title text-xl font-medium">Average Rain</div>
                <div class="collapse-content">
                    <p id="average-rain-value"></p>
                </div>
            </div>
            <div class="collapse collapse-arrow bg-base-200 w-[50%]">
                <input type="radio" name="my-accordion-2" />
                <div class="collapse-title text-xl font-medium">Average Soil Moisture</div>
                <div class="collapse-content">
                    <p id="average-soil-moisture-value"></p>
                </div>
            </div>
            <div class="collapse collapse-arrow bg-base-200 w-[50%]">
                <input type="radio" name="my-accordion-2" />
                <div class="collapse-title text-xl font-medium">Average Water Proximity</div>
                <div class="collapse-content">
                    <p id="average-water-proximity-value"></p>
                </div>
            </div>
            <div class="collapse collapse-arrow bg-base-200 w-[50%]">
                <input type="radio" name="my-accordion-2" />
                <div class="collapse-title text-xl font-medium">Elevation</div>
                <div class="collapse-content">
                    <p id="elevation-value"></p>
                </div>
            </div>
            <div class="collapse collapse-arrow bg-base-200 w-[50%]">
                <input type="radio" name="my-accordion-2" />
                <div class="collapse-title text-xl font-medium">Max Rain</div>
                <div class="collapse-content">
                    <p id="max-rain-value"></p>
                </div>
            </div>
            <div class="collapse collapse-arrow bg-base-200 w-[50%]">
                <input type="radio" name="my-accordion-2" />
                <div class="collapse-title text-xl font-medium">Population</div>
                <div class="collapse-content">
                    <p id="population-value"></p>
                </div>
            </div>
            <div class="collapse collapse-arrow bg-base-200 w-[50%]">
                <input type="radio" name="my-accordion-2" />
                <div class="collapse-title text-xl font-medium">Precipitation</div>
                <div class="collapse-content">
                    <p id="precipitation-value"></p>
                </div>
            </div>
        </div>


    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 SoFlood. Made with ❤️ by the <a href="https://github.com/your-repo-link" target="_blank">Carpal
                Tunnel Team</a>.</p>
    </footer>

    <!--<script async-->
    <!--    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDrx8wK6-zu7qePHwFpUEfbyU0Ib74jFqI&loading=async&libraries=places&callback=initAutocomplete"></script>-->
    <!--<script async src="{{url_for('static',filename='javascript/script.js')}}"></script>-->

    <script>

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);

            const lat = urlParams.get('lat');
            const lng = urlParams.get('lng');
            const zip = urlParams.get('zip');

            console.log({lat, lng});
            fetch(`http://localhost:5000/make_flood_prediction?zip=${zip}&lat=${lat}&long=${lng}`).then((val) => {
                val.json().then((value) => {

                    const loader = document.querySelector('#loader');
                    const mainContent = document.querySelector('#main-content');
                    const femaPredictionValue = document.querySelector('#fema-prediction-value');
                    const carpalTunnelPredictionValue = document.querySelector('#carpal-tunnel-prediction-value');

                    const femaPrediction = value.data["FEMA prediction"];
                    const {
                        predicted_value,
                        avg_rain,
                        avg_soil_moisture,
                        avg_water_prox,
                        elevation,
                        max_rain,
                        population,
                        precipitation,
                    } = value.data;

                    femaPredictionValue.textContent = femaPrediction;
                    carpalTunnelPredictionValue.textContent = predicted_value;

                    const averageRainValue = document.querySelector('#average-rain-value');
                    averageRainValue.textContent = avg_rain;
                    const averageSoilMoisture = document.querySelector('#average-soil-moisture-value');
                    averageSoilMoisture.textContent = avg_soil_moisture;
                    const averageWaterProximity = document.querySelector('#average-water-proximity-value');
                    averageWaterProximity.textContent = avg_water_prox;
                    const elevationValue = document.querySelector('#elevation-value');
                    elevationValue.textContent = elevation;
                    const maxRainValue = document.querySelector('#max-rain-value');
                    maxRainValue.textContent = max_rain;
                    const populationValue = document.querySelector('#population-value');
                    populationValue.textContent = population;
                    const precipitationValue = document.querySelector('#precipitation-value');
                    precipitationValue.textContent = precipitation;

                    console.log({...value.data});
                    loader.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                })
            })
        });
    </script>
</body>

</html>
